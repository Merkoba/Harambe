{% extends "base.jinja" %}

{% block head %}
<title>{{title}}</title>
<link rel="stylesheet" href="/static/css/admin.css">

<script>
    const vars = {}
    vars.mode = {{mode | tojson | safe}}
    vars.page_size = {{page_size | tojson | safe}}
    vars.def_page_size = {{def_page_size | tojson}}
    vars.sort = {{sort | tojson | safe}}
    vars.page = {{page}}
    vars.user_id = {{user_id}}
    vars.username = {{username | tojson | safe}}
    vars.user_name = {{user_name | tojson | safe}}
    vars.next_page = {{next_page | tojson}}
    vars.used_user_id = {{used_user_id}}
</script>

<script src="/static/js/main/admin.js"></script>
{% endblock %}

{% block body %}
<div id="top" class="nowrap">
    <div id="menu" class="action_button">Menu</div>
    <div class="sep">|</div>
    <div class="action_button" id="refresh" title="Refresh this page">Refresh</div>
    <div class="sep">|</div>

    {% if mode == "admin_reactions" %}
    <div class="action_button" id="delete_selected" title="Delete selected item">Delete</div>
    <div class="sep">|</div>
    <div class="action_button" id="delete_all" title="Delete all items (from all pages)">Del All</div>
    <div class="sep">|</div>
    {% endif %}

    {% if mode == "reactions_admin" %}
    <div class="action_button" id="delete_selected" title="Delete selected items">Delete</div>
    <div class="sep">|</div>
    <div class="action_button" id="delete_all" title="Delete all items (from all pages)">Del All</div>
    <div class="sep">|</div>
    {% endif %}
    <div title="Total storage stats of all items (on all pages)">Total: {{total}}</div>
    <div class="sep">|</div>
    <div title="This is the current page">Page {{page}}</div>
    <div class="sep">|</div>

    {% if page > 1 %}
    <div id="prev_page" title="Go to the previous page" class="action_button">Prev</div>
    {% else %}
    <div class="unselectable">Prev</div>
    {% endif %}

    <div class="sep">|</div>

    {% if next_page %}
    <div id="next_page" class="action_button" title="Go to the next page">Next</div>
    {% else %}
    <div class="unselectable">Next</div>
    {% endif %}

    <div class="sep">|</div>
    <select id="page_select" title="Show this number of items per page"></select>
    <div class="sep">|</div>
    <input id="filter" type="text" placeholder="Filter" title="Press Enter to search">
</div>

<div id="items">
    <div class="table">
        <div class="table_row table_header">
            <div class="table_cell checkbox"><input id="checkbox" type="checkbox" title="Select or Unselect All"></div>

            <div id="post" class="table_cell" title="The post where it was posted">
                <div class="header_text" data-sort="post">Post</div>
            </div>

            <div id="value" class="table_cell" title="The value of the reaction">
                <div class="header_text" data-sort="value">Value</div>
            </div>

            <div id="username" class="table_cell" title="The username who did the reaction">
                <div class="header_text" data-sort="user">User</div>
            </div>

            <div id="date" class="table_cell" title="The date when this reaction was made">
                <div class="header_text" data-sort="date">Date</div>
            </div>
        </div>

        {% for item in items %}
        <div class="table_row item" data-id="{{item.id}}" data-user_id="{{item.user_id}}"
        data-username="{{item.username}}" data-name="{{item.name}}" data-user_id="{{item.user_id}}"
        data-post="{{item.pname}}" data-date="{{item.date_str}}" data-ago="{{item.ago}}"
        data-value="{{item.value}}" data-uname="{{item.uname}}">
            <!-- Checkbox -->
            <div class="table_cell checkbox" title="Select this item">
                <input class="select_checkbox" type="checkbox">
            </div>

            <!-- Post -->
            <a href="/post/{{item.pname}}" class="table_cell" title="{{item.pname}}">{{item.pname}}</a>

            <!-- Value -->
            <div class="table_cell reaction_value" title="{{item.value_sample}}">{{item.value_sample}}</div>

            {% if mode == "reactions_admin" %}
            <!-- Username -->
            <div class="table_cell admin_user action_button" title="{{item.uname}}">{{item.username}}</div>
            {% else %}
            <div class="table_cell admin_user action_button" title="{{item.uname}}">{{item.uname}}</div>
            {% endif %}

            <!-- Date -->
            <div class="table_cell" title="{{item.date_str}}">{{item.ago}}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}